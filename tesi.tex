% LuaLatex

\documentclass[LaM, binding=1.8cm]{sapthesis}

\usepackage{fontspec}
\usepackage{microtype}
\usepackage[nodisplayskipstretch]{setspace}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{bm}
\usepackage{wasysym}
\usepackage{comment}
\usepackage{enumitem}
\usepackage{tikz}
\usepackage{forest}
\usepackage{caption}
\usepackage{subfig}
\usepackage{pgfplots}
\usepackage{titlesec}
\usepackage{varioref}
\usepackage[noprefix,refpage]{nomencl}
\usepackage{algorithm}
\usepackage{algorithmicx}
\usepackage{algpseudocode}
\usepackage[newfloat,chapter]{minted}
\usepackage{biblatex}
\usepackage{xurl}
\usepackage[hidelinks]{hyperref}

% Bibliography
\addbibresource{bibliography.bib}

% Sections in new pages
\newcommand{\sectionbreak}{\clearpage}
\let\savedsectionbreak\sectionbreak

% Nomenclature with page links
\renewcommand{\pagedeclaration}[1]{, \hyperlink{page.#1}{page\nobreakspace#1}}

% Math aliases
\DeclarePairedDelimiter{\abs}{\lvert}{\rvert}
\DeclarePairedDelimiter{\norm}{\lVert}{\rVert}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator{\Ber}{Ber}
\DeclareMathOperator{\Cat}{Cat}
\DeclareMathOperator{\sigm}{sigm}
\newcommand{\gauss}[2]{\mathcal{N}(#1,#2)}
\newcommand{\bvec}[1]{\mathbf{#1}}
\newcommand{\setSym}[1]{\mathcal{#1}}
\newcommand{\ltl}{$\text{LTL}_f$}
\newcommand{\ldl}{$\text{LDL}_f$}
\newcommand{\re}{$\text{RE}_f$}
\newcommand{\until}{\mathcal{U}}
\newcommand{\eventually}{\lozenge}
\newcommand{\always}{\square}
\newcommand{\lnext}{\Circle}
\renewcommand{\lnot}{\neg}
\newcommand{\const}[1]{\text{\textit{#1}}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\B}{\mathbb{B}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\indicator}{\mathbb{I}}
\newcommand{\softmax}{\mathcal{S}}
\newcommand{\I}{\mathbf{I}}
\newcommand{\zero}{\mathbf{0}}
\newcommand{\onevec}{\mathbf{1}}
\newcommand{\true}{\const{true}}
\newcommand{\false}{\const{false}}
\newcommand{\set}[1]{\{#1\}}
\newcommand{\given}{\mid}
\newcommand{\eps}{$\epsilon$}  % eps in text
\newcommand{\ldiamond}[1]{\langle\, {#1} \,\rangle}
\newcommand{\lbox}[1]{[\, {#1} \,]}
\newcommand{\mathiff}{\quad \text{iff} \quad}
\newcommand{\mathand}{\quad \text{and} \quad}
\newcommand{\mathor}{\quad \text{or} \quad}
\newcommand{\lboolsetplus}[1]{\mathcal{B}^+(#1)}
\newcommand{\relu}{ReLU}
\newcommand{\x}{\bvec{x}}
\newcommand{\bv}{\bvec{v}}
\newcommand{\bh}{\bvec{h}}

\newcommand{\code}{\texttt}
\newcommand{\param}{\theta}
\newcommand{\params}{\bm{\theta}}
\newcommand{\est}[1]{\hat{#1}}
\newcommand{\optimal}[1]{{#1}_*}
\newcommand{\fluents}{\setSym{F}}
\newcommand{\fluent}{p}
\newcommand{\formula}{\varphi}
\newcommand{\propformula}{\phi}
\newcommand{\trace}{\pi}
\newcommand{\resym}{\rho}
\newcommand{\modelsym}{\setSym{M}}
\newcommand{\langsym}{\setSym{L}}
\newcommand{\ltt}{\const{tt}}
\newcommand{\lff}{\const{ff}}
\newcommand{\discount}{\gamma}
\newcommand{\policy}{\rho}
\newcommand{\stateS}{S}  % Don't change, because s_i won't be updated
\newcommand{\obsS}{\Omega}
\newcommand{\group}[1]{^{(#1)}}
\newcommand{\lend}{\const{End}}
\newcommand{\llast}{\const{Last}}
\newcommand{\automa}{\mathcal{A}}
\newcommand{\nmrdpS}{\mathcal{N}}
\newcommand{\mdpS}{\mathcal{M}}
\newcommand{\highlevelS}{L}
\newcommand{\convlayer}[3]{Conv(#1, #2, #3)} % Abbreviation for
	% Convolutional layer. Params: n filters, size, stride
\newcommand{\denselayer}[1]{Dense(#1)}
\newcommand{\slicelayer}[1]{Slice(#1)}
\newcommand{\constraintS}{\psi}
\newcommand{\basisfun}{\bm{\phi}}
\newcommand{\basisfuni}{\phi}
\newcommand{\dataset}{\setSym{D}}
\newcommand{\linpar}{\mathbf{w}}
\newcommand{\linparmat}{\mathbf{W}}
\newcommand{\linpari}{w}		
\newcommand{\layernum}[2]{\prescript{#1}{}{#2}}
\newcommand{\heuristicfn}{f_{\text{he}}}
% Geometries
\newcommand{\boxstart}{(0.4625, 0.3762) rectangle (0.5437, 0.4143)}
\newcommand{\boxrope}{(0.6813, 0.5524) rectangle (0.725, 0.6286)}
\newcommand{\boxblueright}{(0.2, 0.4143) rectangle (0.95, 0.4429)}
\newcommand{\boxpaddleleft}{(0.05, 0.8857) rectangle +(0.2, 0.0476)}
\newcommand{\boxbreakout}{(0.05, 0.1524) rectangle (0.95, 0.9381)}

% TikZ
\usetikzlibrary{arrows}
\usetikzlibrary{arrows.spaced}
\usetikzlibrary{fit}
\usetikzlibrary{positioning}
\usetikzlibrary{calc}
\usetikzlibrary{graphs}
\usetikzlibrary{graphs.standard}
\usetikzlibrary{matrix}
\usetikzlibrary{intersections}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{decorations.pathreplacing}
\usetikzlibrary{patterns}
\usetikzlibrary{quotes}
\usetikzlibrary{graphdrawing}

\pgfdeclarelayer{below}
\pgfdeclarelayer{beloww}
\pgfsetlayers{beloww,below,main}

\usegdlibrary{layered,trees,force}

\tikzset{
	>=stealth',
	ampersand replacement=\&,
	every node/.style={align=center},
	%
	block/.style={
		rounded corners=4pt, draw, fill=white, inner sep=6pt, outer sep=1pt},
	box/.style={rounded corners=4pt, inner sep=1.8ex, draw=#1!50,
		fill=#1!20},
	image/.style={inner sep=0pt, outer sep=3pt},
	tight/.style={inner sep=0pt, outer sep=0pt},
	region box/.style={draw=orange, semithick},
	dot/.style={fill, circle, inner sep=0.7pt},
	node/.style={draw, fill=white, circle, semithick, inner sep=0pt, minimum
		size=1.7ex},
	observed node/.style={node, fill=lightgray},
	%
	flow/.style={->, thick, >=spaced stealth'},
	arrow/.style={->, semithick},
	pin line/.style={-, very thin, draw=gray},
	%
	accept/.style={double},
	reject/.style={fill=lightgray},
	backward/.style={bend #1}, backward/.default=right,
	init path/.style={
		->, decoration={snake, amplitude=0.2mm, segment length=2mm}, decorate},
	self loop right/.style={to path={
		.. controls +(-20:1) and +(20:1) .. (\tikztotarget) \tikztonodes}},
	self loop above/.style={to path={
		.. controls +(70:1) and +(110:1) .. (\tikztotarget) \tikztonodes}},
	self loop left/.style={to path={
		.. controls +(160:1) and +(200:1) .. (\tikztotarget) \tikztonodes}},
	self loop below/.style={to path={
		.. controls +(250:1) and +(290:1) .. (\tikztotarget) \tikztonodes}},
	%
	encoding vector/.style={
		matrix of nodes, nodes in empty cells,
		row sep=-\pgflinewidth, column sep=-\pgflinewidth,
		nodes={anchor=center, draw, minimum width=1.3em, minimum height=1.3em,
			inner sep=0pt, font=\footnotesize, fill=white},
		cells={draw},
	},
	rule box/.style={
		fill=gray!30!white,
	},
	%
	command text/.style={
		font=\small\ttfamily, outer sep=1ex,
	},
}
% Automaton graph style
\pgfkeys{
    /tikz/graphs/automaton/.style={
        nodes={draw, circle},
        edge quotes={font={\small}, inner ysep=0.5ex, inner xsep=0.2ex,
					auto=right, pos=0.5}
    }
}
% Forest styles
\forestset{
	dirtree/.style = {
		for tree={
			font=\ttfamily,
			grow'=0,
			child anchor=west,
			parent anchor=south,
			anchor=west,
			calign=first,
			edge path={
				\noexpand\path [draw, \forestoption{edge}]
				(!u.south west) +(7.5pt,0) |- node[dot] {}
				(.child anchor)\forestoption{edge label};
			},
			before typesetting nodes={
				if n=1
					{insert before={[,phantom]}}
					{}
			},
			fit=band,
			before computing xy={l=15pt},
			s sep=4pt,
		}
	}
}

% pgfplots
\pgfplotsset{
	compat=1.16,
	every axis/.style={font=\scriptsize},
	metrics/.style={
		mark=none,
		xmin=0,
		grid=major,
		scale only axis,
	},
	cycle list={
		{blue!40!black},
		{red!40!black},
		{green!40!black},
		{brown},
	},
	table keys/.is family,
}

% Algorithms
	% Repeat without end label
\algblockdefx{EndlessRepeat}{EndRepeat}{\textbf{repeat}}{}
\algnotext{EndRepeat}
	% Input and outputs are \Require \Ensure
\algrenewcommand\algorithmicrequire{\textbf{Input:}}
\algrenewcommand\algorithmicensure{\textbf{Output:}}
	% Indented lines with Statex
\makeatletter
\let\OldStatex\Statex
\renewcommand{\Statex}[1][3]{%
  \setlength\@tempdima{\algorithmicindent}%
  \OldStatex\hskip\dimexpr#1\@tempdima\relax}
\makeatother

% Minted
\setminted[py3]{tabsize=4}
\usemintedstyle[py3]{tango}
\setminted[json]{tabsize=2}
\usemintedstyle[json]{stata}

% Suppress useless warnings
\hfuzz=2pt

% Colors
\newcommand{\encodingColor}{orange!70!white}
\newcommand{\boolsColor}{blue!70!white}
\newcommand{\fluentsColor}{gray}

% Teoremi?
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}
\theoremstyle{definition}
\newtheorem{example}{Example}
\newtheorem{definition}{Definition}

% TODO: exam date and examiner infos

% Line space
\onehalfspacing

% Nomenclature
\makenomenclature

% Pdf info
\hypersetup{pdftitle={Tesi Magistrale Roberto Cipollone},pdfauthor={Roberto
Cipollone}}

% Thesis info
\title{Symbol Grounding in Deep Reinforcement Learning agents for
non-Markovian rewards}
\author{Roberto Cipollone}
\IDnumber{1528014}
\course{Artificial Intelligence and Robotics}
\courseorganizer{Facoltà di Ingegneria dell’Informazione, Informatica e
Statistica}
\submitdate{2019/2020}
\copyyear{2020}
\advisor{Prof. Giuseppe De Giacomo}
\authoremail{cipollone.rt@gmail.com}


\begin{document}

% TODO: abstract
% TODO: dedication?

% Title pages
\frontmatter
\maketitle
\tableofcontents
\printnomenclature[2cm]

% Chapters
\mainmatter


\include{chapters/ch_intro}
\include{chapters/ch_logics}
\include{chapters/ch_rl}
\include{chapters/ch_fluents}
\include{chapters/ch_atarieyes}
\include{chapters/ch_experiments}
\include{chapters/ch_conclusions}

% Backmatter
\backmatter
\printbibliography

\end{document}
